// 영화 데이터
const movies = {
    'dusk-till-dawn': {
        titleKr: '황혼에서 새벽까지',
        titleEn: 'From Dusk till Dawn',
        details: '1996·액션/범죄/공포·미국, 멕시코',
        runtime: '1시간 48분·청불',
        rating: 5,
        plot: `세스와 리처드 게코 형제는 텍사스에서 은행 강도를 저지른 후 멕시코로 도주한다. 그들은 인질로 잡은 목사 제이컵 풀러와 그의 두 자녀 케이트와 스콧을 데리고 멕시코 국경을 넘는다.

목적지인 엘 레이 바에 도착한 그들은 그곳이 뱀파이어들의 소굴이라는 것을 알게 된다. 밤이 되자 바의 직원들과 손님들이 모두 뱀파이어로 변해 그들을 공격하기 시작한다.

생존을 위해 뱀파이어들과 싸우는 과정에서 많은 사람들이 죽고, 세스와 케이트만이 살아남아 새벽이 되어 뱀파이어들이 모두 사라진 후 탈출한다.`,
        review: ['네제가다죽자영화정말좋아하는데요 놉을밧고요 그다음 씨너스 그다음 황혼에서새벽까지바보겟습니다~']
    },
    'kpop-demon-hunters': {
        titleKr: '케이팝 데몬 헌터스',
        titleEn: 'K-Pop Demon Hunters',
        details: '2025·애니메이션/음악/코미디/모험·미국',
        runtime: '1시간 35분 · 12세',
        rating: 5,
        plot: `전 세계적인 인기를 누리는 케이팝 걸그룹이 사실은 악마를 사냥하는 비밀 조직이라는 설정에서 이야기가 시작됩니다.
무대 위에서는 완벽한 아이돌이지만, 무대 아래에서는 인간 세상에 숨어든 악마들과 싸우는 이중생활을 하고 있죠.
이들에게 음악과 퍼포먼스는 단순한 공연이 아니라 악마를 제압하는 가장 강력한 무기입니다.
하지만 어느 순간, 악마들 역시 아이돌의 모습으로 인간 사회에 스며들고 있다는 사실이 드러납니다.
주인공들은 자신들의 정체를 숨긴 채 더 위험한 싸움에 뛰어들게 됩니다.
그 과정에서 팀 내 갈등과 각자의 불안이 표면으로 올라오며, 서로를 믿는 일이 가장 큰 과제가 됩니다.`,
        review: [
            '케데헌 3회차 드가야지','미라너무예쁘다','목욕탕 시퀀스 너무좋음 이거보려고케데헌켰다 케데헌은진짜전설이다...'
        ]
    },
    'substance': {
        titleKr: '서브스턴스',
        titleEn: 'Substance',
        details: '2024 · 공포/드라마 · 영국, 미국',
        runtime: '2시간 21분 · 청불',
        rating: 5,
        plot: `서브스턴스는 한때 스타였지만 나이 듦으로 밀려난 여성이 ‘더 나은 나’를 만들어준다는 의문의 약물을 접하며 시작되는 이야기입니다. 그 약물은 젊고 완벽한 또 다른 자아를 만들어내고, 두 존재는 하나의 삶을 나눠 살아가야 한다는 규칙을 따르게 됩니다. 처음에는 잃어버린 명성과 욕망을 되찾은 듯 보이지만, 점점 통제는 무너지고 균형은 깨집니다.
젊음과 성공을 향한 집착은 두 자아 사이의 갈등을 낳고, 몸과 정체성의 경계도 서서히 붕괴됩니다.
영화는 사회가 요구하는 ‘이상적인 몸’과 자기혐오를 극단적인 신체 공포로 밀어붙입니다.
결국 이 선택이 무엇을 대가로 요구하는지, 그리고 진짜 ‘나’란 무엇인지 잔혹하게 드러냅니다..`,
        review: ['한줄평이 없습니다.']
    },
    'alien': {
        titleKr: '에이리언',
        titleEn: 'Alien',
        details: '1979·SF/공포·영국, 미국',
        runtime: '1시간 57분·15세 관람가',
        rating: 5,
        plot: `2122년. 상업 우주 화물선 '노스트로모'호는 2천만 톤의 광물을 싣고 승무원 일곱 명과 함께 지구로 향하고 있다. 우주선의 메인 컴퓨터 MU-TH-R 182, 약칭 "마더(Mother)"는 한 혹성의 궤도를 선회하는 위성에서 정체를 알 수 없는 신호를 포착한다. 미리 프로그램된 대로 "마더"는 이 신호를 탐색하기 위해 동면해 있는 승무원들을 깨운다. 
        '노스트로모'호는 광물운반과 채굴장비로부터 분리되어 위성에 착륙을 시도하고, 위성에 하강하는 도중에 약간의 손상을 입는다.
선장 달라스(톰 스케릿), 부선장 케인(존 허트), 항법사 램버트(베로니카 카트라이트)는 신호를 조사하기 위해 우주선을 떠난다. 그들은 오래전에 추락한 알 수 없는 문명의 비행선과 조우하게 되고, 그 비행선 안에서 미이라화한 파일럿을 발견한다. 
케인은 파일럿 근처에서 구멍을 발견하고 거기로 내려가 수천 개의 거죽에 둘러싸인 알들을 발견한다. 그중 알 하나가 열려, 안에서 튀어나온 '페이스 허거'가 케인이 쓰고 있던 헬멧을 녹이고 그의 얼굴에 달라붙는다. 달라스와 램버트는 정신을 잃은 케인을 데리고 '노스트로모'호로 돌아온다. 
리플리(시고니 위버)는 '달라스'와 '케인'이 부재시 명령권이 있는 장교로 검역절차에 따라 그들이 선내에 들어오는 것을 거부했지만, 과학장교 애쉬(이안 홈)가 리플리의 결정에 불복종하여 그들을 우주선 안으로 들인다. 
우주선의 의무실에서 달라스와 애쉬는 케인의 얼굴에 달라붙은 괴물을 케인에게 해를 입히지 않고 떼어내기는 불가능했고, 괴물의 관절부위를 잘라내려 하자 강산성 체액이 뿜어나와 우주선 바닥을 수겹이나 뚫었다. 이것이 괴물의 '치명적인 방어기제'였다. 
선원들은 그래서 괴물을 떼어내기를 포기했고 괴물은 얼마후 케인의 얼굴에서 스스로 떨어져 죽어 버린다. 이후 케인은 겉으로 보기에 아무 문제없이 깨어난다.`,
        review: ['에이리언1 보고있는데 너무재미잇슴','오늘 에이리언 광고보고 제모노프섹시하다햇다가 한소리들었음']
    },
    'everything-everywhere': {
        titleKr: '에브리씽 에브리웨어 올 앳 원스',
        titleEn: 'Everything Everywhere All at Once',
        details: '2022·액션/코미디/드라마·미국',
        runtime: '2시간 19분·15세 관람가',
        rating: 5,
        plot: '줄거리 정보가 없습니다.',
        review: ['한줄평이 없습니다.']
    },
    'Sympathy-for-Mr.-Vengeance': {
        titleKr: '복수는 나의 것',
        titleEn: 'Sympathy for Mr. Vengeance',
        details: '2002·범죄/스릴러·한국',
        runtime: '2시간 00분·청불',
        rating: 5,
        plot: `농아자인 류(신하균)는 신장 병으로 죽어가는 누나에게 맞는 신장을 구하지 못하자 불법 브로커들에게 자신의 신장과 누나의 수술비 천만원을 주고 그 대가로 누나에게 적합한 신장을 구하고자 했지만 사기를 당하고 만다. 그 후 극렬한 무정부주의자인 애인과 함께 누나의 신장이식 수술비를 마련하기 위해 중소기업 사장의 딸을 유괴하고 몸값을 요구하려고 계획을 세운다. 그 둘이 사장과 아이를 미행하던중 회사의 또 다른 해고자가 사장 앞에서 자해 시위를 하는 것을 보게 되고 회사의 해고자인 류(신하균)는 사장의 딸을 유괴하면 원한을 산 사람이 용의자 1순위가 될 것이라고 생각하고 운전자이자 이사인 동진(송강호)의 딸을 유괴한다. 사장의 운전자이자 이사인 동진(송강호)은 경찰에게 알리지 않고, 딸을 구하기 위해 몸값을 지불한다. 신하균과 영미(배두나)가 몸값을 받기 위해 동진(송강호)에게 범행을 저지르는 동안 류(신하균)의 누나는 빨래를 하다가 류(신하균)의 바지 주머니에서 퇴직금 정산서를 보게 된다. 자신의 수술비를 마련하기 위해 동생이 아이를 유괴했다는 것을 알게 된 류(신하균)의 누나는 자살하고 만다. 그 사실을 모르고 돈가방을 들고 집으로 돌아간 류(신하균)는 아이에게서 누나의 유언장을 받게 되고 욕실에서 누나의 사체를 발견한다. 누나의 유언대로 어릴적 자주 놀던 강가에 묻어주기 위해 간 곳에서 동진(송강호)의 딸은 사고로 익사하게 되었다. 딸이 주검으로 발견되었다는 소식을 들은 동진(송강호)은 복수심에 불타게 되고 경찰에게 돈을 쥐어주고 류(신하균)의 소재를 찾게 된다. 류(신하균)가 자신을 속였던 신장 불법 브로커들에게 복수하기 위해 떠난 사이 동진(송강호)은 류(신하균) 애인 영미(배두나)의 집으로 가서 전기고문으로 사망하게 만든다. 류(신하균)가 불법 브로커를 모두 죽인후 영미(배두나)의 집으로 간다. 하지만 곧 애인이 사망했다는 사실을 안 류(신하균)는 다시 복수하기 위해서 동진(송강호)을 찾아가지만, 오히려 역으로 당하고 만다. 그는 자신의 딸이 죽은 곳(즉, 류의 누나가 묻힌 곳)으로 데려가 류(신하균)의 목숨을 끊음으로써 복수를 완수한다. 그러나 동진(송강호)은 그곳에서 영미(배두나)가 소속되어있던 극렬 사회주의 단체의 복수에 의해 마찬가지로 죽음을 맞이하고 만다.`,
        review: [
            '저는 차눅팍 복수3부작중에는 복나것이 젤 조와요',
        '가장 세련된느낌'
    ]
    }
    
    // 새로운 영화를 추가하려면 아래 형식을 따라주세요
    // '영화-id': {
    //     titleKr: '한국어 제목',
    //     titleEn: 'English Title',
    //     details: '연도·장르·국가',
    //     runtime: '상영시간·등급',
    //     rating: 0,  // 0~5 사이의 숫자 (0.5 단위 가능)
    //     plot: '줄거리를 여기에 작성하세요.',
    //     review: '한줄평을 여기에 작성하세요.'
    // }
};

// 페이지 전환 함수
function showPage(pageId) {
    document.querySelectorAll('.page').forEach(page => {
        page.classList.remove('active');
    });
    document.getElementById(pageId).classList.add('active');
}

// 뒤로가기 함수
function goBack() {
    showPage('home-page');
    // URL 해시 제거
    history.pushState('', document.title, window.location.pathname);
}

// 별점 표시 함수
// 이 사이트는 항상 5개짜리 별만 표시합니다
const STAR_FILLED_PATH = 'images/fillstar.svg'; // 꽉 찬 별 경로

function renderStars() {
    // 항상 5개의 꽉 찬 별만 표시
    let starsHtml = '';
    for (let i = 0; i < 5; i++) {
        starsHtml += `<img src="${STAR_FILLED_PATH}" alt="별" class="star-img star-filled" />`;
    }
    return starsHtml;
}

// 영화 상세 페이지 렌더링
function renderMovieDetail(movieId) {
    const movie = movies[movieId];
    if (!movie) return;

    // 영화 제목 설정 (index.html에서 추가한 h1.movie-title)
    document.querySelector('.detail-header .movie-title').textContent = movie.titleKr;
    
    const content = `
        <div class="movie-header">
            <hr class="header-line">
        </div>
        <div class="movie-info">
            <div class="movie-title-en">${movie.titleEn}</div>
            <div class="movie-details">${movie.details}</div>
            <div class="movie-runtime">${movie.runtime}</div>
            <div class="star-rating">
                ${renderStars()}
            </div>
        </div>
        <div class="plot-section">
            <div class="plot-text">${movie.plot}</div>
        </div>
        <div class="review-section">
            <hr class="review-line">
            <div class="review-title">나의 한줄평</div>
            ${Array.isArray(movie.review) 
                ? movie.review.map(review => `
                    <div class="review-box">
                        <div class="review-text">${review}</div>
                    </div>
                `).join('')
                : `
                    <div class="review-box">
                        <div class="review-text">${movie.review}</div>
                    </div>
                `
            }
        </div>
    `;
    
    document.getElementById('movie-content').innerHTML = content;
}

// 영화 버튼 동적 생성
function renderMovieButtons() {
    const buttonsContainer = document.getElementById('movie-buttons');
    buttonsContainer.innerHTML = ''; // 기존 버튼 제거
    
    // movies 객체의 모든 영화를 순회하며 버튼 생성
    Object.keys(movies).forEach(movieId => {
        const movie = movies[movieId];
        const button = document.createElement('button');
        button.className = 'movie-button';
        button.setAttribute('data-movie', movieId);
        button.textContent = movie.titleKr;
        buttonsContainer.appendChild(button);
    });
}

// 영화 버튼 클릭 이벤트
document.addEventListener('DOMContentLoaded', function() {
    // 영화 버튼들 동적 생성
    renderMovieButtons();
    
    // 이벤트 위임을 사용하여 동적으로 생성된 버튼에도 이벤트 적용
    const buttonsContainer = document.getElementById('movie-buttons');
    buttonsContainer.addEventListener('click', function(e) {
        if (e.target.classList.contains('movie-button')) {
            const movieId = e.target.getAttribute('data-movie');
            renderMovieDetail(movieId);
            showPage('detail-page');
            // URL 해시 업데이트
            window.location.hash = movieId;
        }
    });
    
    // URL 해시로 직접 접근한 경우 처리
    if (window.location.hash) {
        const movieId = window.location.hash.substring(1);
        if (movies[movieId]) {
            renderMovieDetail(movieId);
            showPage('detail-page');
        }
    }
    
    // 브라우저 뒤로가기 버튼 처리
    window.addEventListener('popstate', function() {
        if (!window.location.hash) {
            showPage('home-page');
        }
    });
});

